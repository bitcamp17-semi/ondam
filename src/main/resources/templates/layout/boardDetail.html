<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>게시글 작성</title>-->
<!--    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>-->
<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">-->
<!--</head>-->
<!--<body>-->
<div id="boardDetail" th:fragment="boardDetail">
    <div class="main-container">

        <form id="boardfrm" method="post"
              enctype="multipart/form-data" th:object="${board}">

            <!-- 제목 입력 -->
            <div class="form-group">
				제목 : &nbsp;<p id="title" th:text="${board.title}"></p>
            </div>

			<div class="form-group writer-group">
				<p th:text="${board.authorName}">작성자 없음</p>
				<p id="createdAt" th:text="${#dates.format(board.createdAt, 'yyyy-MM-dd HH:mm:ss')}"></p>
			</div>

            <!-- 내용 입력 -->
            <div class="form-group">
                <p id="content" th:text="${board.content}"></p>
            </div>


            <!-- hidden 값 -->
            <input type="hidden" name="hidden" id="hidden" th:value="${board.hidden}"/>

        </form>
    </div>
</div>

<script type="text/javascript">
    // 카테고리 변경 시 hidden 값과 안내문구 처리
    $("#selectCategory").on("change", function () {
        const isAnon = $(this).val() === "anonimity";
        $("#hidden").val(isAnon ? "true" : "false");
        $("#anon-notice").toggle(isAnon);
    });

    // AJAX 폼 제출 처리
    $(function () {
        $('#boardfrm').on("submit", function (e) {
            e.preventDefault();
            const category = $("#selectCategory").val();
            $("#hidden").val(category === "anonimity" ? "true" : "false");

            const formData = new FormData(this);

            $.ajax({
                type: 'POST',
                url: "/board/boardInsert",
                data: formData,
                contentType: false,
                processData: false,
                success: function (res) {
                    if (res.result > 0) {
                        alert("게시글이 업로드 되었습니다.");
                        location.href = "/board/boardMain";
                    } else {
                        alert("다시 시도해주세요.");
                        location.href = "/board/boardMain";
                    }
                },
                error: function () {
                    alert("서버 오류가 발생했습니다.");
                }
            });
        });
    });
</script>
<!--</body>-->
<!--</html>-->