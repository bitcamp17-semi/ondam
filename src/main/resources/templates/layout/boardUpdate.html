<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>게시글 수정</title>
	<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=Gaegu&family=Jua&family=Nanum+Pen+Script&family=Playwrite+AU+SA:wght@100..400&family=Single+Day&display=swap" rel="stylesheet">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
   <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
   <link rel="stylesheet" href="/css/board.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
     
   <style>
       body *{
           font-family: 'Jua';
       }
</style>
</head>
<body>
<div class="container">
    <h2>게시글 수정</h2>

    <form id="updateForm" enctype="multipart/form-data">
    <input type="hidden" name="id" th:value="${board.id}" />

        <!-- 카테고리 선택 -->
        <div class="form-group">
            <label>카테고리</label>
            <select th:field="*{category}">
                <option value="전체게시판">전체게시판</option>
                <option value="익명게시판">익명게시판</option>
                <option value="공지사항">공지사항</option>
                <option value="부서게시판">부서게시판</option>
                <option value="사내소식">사내소식</option>
            </select>
        </div>

        <!-- 제목 -->
        <div class="form-group">
            <label>제목</label>
            <input type="text" th:field="*{title}" placeholder="제목을 입력하세요" />
        </div>

        <!-- 내용 -->
        <div class="form-group">
    		<label>내용</label>
    		<textarea th:field="*{content}" rows="10" placeholder="내용을 입력하세요"></textarea>
		</div>
		
		<input type="hidden" name="hidden" th:value="${board.hidden}" />

        <!-- 버튼 -->
        <div class="form-actions">
            <button type="submit">수정 완료</button>
            <button type="button" onclick="history.back()">취소</button>
        </div>
    </form>
    
    <script>
$(function() {
    $('#updateForm').on('submit', function(e) {
        e.preventDefault();
        const formData = new FormData(this);

        $.ajax({
            type: 'POST',
            url: '/board/update',
            data: formData,
            processData: false,
            contentType: false,
            success: function(res) {
                if(res.result > 0){
                    alert('수정이 완료되었습니다!');
                    location.href = '/board/list';
                } else {
                    alert('수정에 실패했습니다. 다시 시도해주세요.');
                }
            },
            error: function() {
                alert('서버 오류가 발생했습니다.');
            }
        });
    });
});
</script>
</div>
</body>
</html>