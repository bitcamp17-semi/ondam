<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.ChatLogMapper">
    <!-- 메시지 생성 (Create) -->
    <insert id="createChatLog" parameterType="ChatLogDto">
        insert into chat_log (senderid, receiverid, isread, message, groupid, createdat, file)
        values (#{senderId}, #{receiverId}, #{isRead}, #{message}, #{groupId}, #{createdAt}, #{file})
    </insert>

    <!-- 그룹 내 메시지 조회 (Read) -->
    <select id="readChatLogsByGroupId" parameterType="int" resultType="ChatLogDto">
        select id, senderid, receiverid, isread, message, groupid, createdat, file
        from chat_log where groupid = #{groupId} order by createdat asc
    </select>

    <!-- 메시지 수정 (Update) -->
    <update id="updateChatLog" parameterType="ChatLogDto">
        update chat_log set isread = #{isRead}, message = #{message}, file = #{file} where id = #{id}
    </update>

    <!-- 메시지 삭제 (Delete) -->
    <delete id="deleteChatLog" parameterType="long">
        delete from chat_log where id = #{id}
    </delete>
</mapper>
